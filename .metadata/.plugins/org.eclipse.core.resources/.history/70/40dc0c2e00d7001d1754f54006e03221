/*
 * Counter.c
 *
 *  Created on: 6 abr 2023
 *      Author: mgnar
 */
#include "stm32f4xx_hal.h"
#include "stm32f4xx_hal_tim.h"
#include "Counter.h"


TIM_HandleTypeDef HTim2 ={0};


void HAL_TIM_PeriodElapsedCallback(TIM_HandleTypeDef *htim)
{
	// Interrupci칩n cada segundo mediante TIM3.

}

void TIM1_IRQHandler(void)
{
	HAL_TIM_IRQHandler(&HTim2);
}



void TIM1Init(void)
{
	//Habilitar se침ales de reloj
	__HAL_RCC_TIM2_CLK_ENABLE();


	//Configuraci칩n de alto nivel
	HTim2.Instance = TIM2;
	HTim2.Init.CounterMode = TIM_COUNTERMODE_UP;
	HTim2.Init.Prescaler = 9999; // Ck_CNT = Ck_PSC / (1 + Preescaler)
	HTim2.Init.Period = 4999; // Freq_int = Ck_CNT / (1 + Period)

	//Habilitar la interrupci칩n
	HAL_NVIC_SetPriority(TIM2_IRQn, 0, 10);
	HAL_NVIC_EnableIRQ(TIM2_IRQn);

	HAL_TIM_Base_Init(&HTim2);
	HAL_TIM_Base_Start_IT(&HTim2);


}

